import{_ as $,D as y,y as S,z as v,a as n,c as l,b as t,d as o,m as b,x as f,n as w,t as x,e as _,j as m,W as M,f as I,v as L,i as k,F as P,g as E,w as F,h as V,k as j,T as U,r as T,p as z,o as O,A as D,B as q}from"./index-Cdy--wcE.js";import{L as g}from"./localeText-DwvvmbTS.js";import{d as C}from"./dayjs.min-B_4C5ugr.js";import{V as Q}from"./vue-datepicker-BjpxqJk-.js";const J={components:{LocaleText:g},props:{targetData:String,title:String,warning:!1,warningText:""},setup(){const s=y(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{value:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.value=this.store.Configuration.Peers[this.targetData]},methods:{async useValidation(){this.changed&&await v("/api/updateDashboardConfigurationItem",{section:"Peers",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Peers[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message),this.changed=!1,this.updating=!1})}}},X={class:"form-group mb-2"},Z=["for"],tt=["id","disabled"],et={class:"invalid-feedback"},st={key:0,class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block mt-1"};function at(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",X,[t("label",{for:this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[o(i,{t:this.title},null,8,["t"])])])],8,Z),b(t("input",{type:"text",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),id:this.uuid,"onUpdate:modelValue":e[0]||(e[0]=a=>this.value=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),onBlur:e[2]||(e[2]=a=>p.useValidation()),disabled:this.updating},null,42,tt),[[f,this.value]]),t("div",et,x(this.invalidFeedback),1),c.warning?(n(),l("div",st,[t("small",null,[e[3]||(e[3]=t("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),o(i,{t:c.warningText},null,8,["t"])])])):_("",!0)])}const it=$(J,[["render",at]]),ot=s=>{},nt={name:"accountSettingsInputUsername",components:{LocaleText:g},props:{targetData:String,title:String},setup(){const s=y(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{value:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.value=this.store.Configuration.Account[this.targetData]},methods:{async useValidation(s){this.changed&&(this.updating=!0,await v("/api/updateDashboardConfigurationItem",{section:"Account",key:this.targetData,value:this.value},e=>{e.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=e.message),this.changed=!1,this.updating=!1}))}}},lt={class:"form-group mb-2"},dt=["for"],rt=["id","disabled"],ut={class:"invalid-feedback"};function ct(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",lt,[t("label",{for:this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[o(i,{t:this.title},null,8,["t"])])])],8,dt),b(t("input",{type:"text",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),id:this.uuid,"onUpdate:modelValue":e[0]||(e[0]=a=>this.value=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),onBlur:e[2]||(e[2]=a=>p.useValidation()),disabled:this.updating},null,42,rt),[[f,this.value]]),t("div",ut,x(this.invalidFeedback),1)])}const ht=$(nt,[["render",ct]]),mt={name:"accountSettingsInputPassword",components:{LocaleText:g},props:{targetData:String,warning:!1,warningText:""},setup(){const s=y(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{value:{currentPassword:"",newPassword:"",repeatNewPassword:""},invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0}},methods:{async useValidation(){Object.values(this.value).find(s=>s.length===0)===void 0?this.value.newPassword===this.value.repeatNewPassword?await v("/api/updateDashboardConfigurationItem",{section:"Account",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isValid=!1,this.value={currentPassword:"",newPassword:"",repeatNewPassword:""}},5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message)}):(this.showInvalidFeedback=!0,this.invalidFeedback="New passwords does not match"):(this.showInvalidFeedback=!0,this.invalidFeedback="Please fill in all required fields.")}},computed:{passwordValid(){return Object.values(this.value).find(s=>s.length===0)===void 0&&this.value.newPassword===this.value.repeatNewPassword}}},pt={class:"d-flex flex-column gap-2"},gt={class:"row g-2"},bt={class:"col-sm"},_t={class:"form-group"},ft=["for"],vt=["id"],yt={key:0,class:"invalid-feedback d-block"},wt={class:"col-sm"},$t={class:"form-group"},kt=["for"],xt=["id"],Dt={class:"col-sm"},It={class:"form-group"},St=["for"],Pt=["id"],At=["disabled"];function Ct(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("form",pt,[t("div",gt,[t("div",bt,[t("div",_t,[t("label",{for:"currentPassword_"+this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[o(i,{t:"Current Password"})])])],8,ft),b(t("input",{type:"password",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),autocomplete:"current-password","onUpdate:modelValue":e[0]||(e[0]=a=>this.value.currentPassword=a),id:"currentPassword_"+this.uuid},null,10,vt),[[f,this.value.currentPassword]]),r.showInvalidFeedback?(n(),l("div",yt,x(this.invalidFeedback),1)):_("",!0)])]),t("div",wt,[t("div",$t,[t("label",{for:"newPassword_"+this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[o(i,{t:"New Password"})])])],8,kt),b(t("input",{type:"password",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),autocomplete:"new-password","onUpdate:modelValue":e[1]||(e[1]=a=>this.value.newPassword=a),id:"newPassword_"+this.uuid},null,10,xt),[[f,this.value.newPassword]])])]),t("div",Dt,[t("div",It,[t("label",{for:"repeatNewPassword_"+this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[o(i,{t:"Repeat New Password"})])])],8,St),b(t("input",{type:"password",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),autocomplete:"new-password","onUpdate:modelValue":e[2]||(e[2]=a=>this.value.repeatNewPassword=a),id:"repeatNewPassword_"+this.uuid},null,10,Pt),[[f,this.value.repeatNewPassword]])])])]),t("button",{disabled:!this.passwordValid,class:"ms-auto btn bg-success-subtle text-success-emphasis border-1 border-success-subtle rounded-3 shadow-sm",onClick:e[3]||(e[3]=a=>this.useValidation())},[e[4]||(e[4]=t("i",{class:"bi bi-save2-fill me-2"},null,-1)),o(i,{t:"Update Password"})],8,At)])}const Tt=$(mt,[["render",Ct]]),Vt={name:"dashboardSettingsInputWireguardConfigurationPath",components:{LocaleText:g},props:{targetData:String,title:String,warning:!1,warningText:""},setup(){const s=y(),e=M(),c=`input_${S()}`;return{store:s,uuid:c,WireguardConfigurationStore:e}},data(){return{value:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.value=this.store.Configuration.Server[this.targetData]},methods:{async useValidation(){this.changed&&(this.updating=!0,await v("/api/updateDashboardConfigurationItem",{section:"Server",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3),this.WireguardConfigurationStore.getConfigurations(),this.store.newMessage("Server","WireGuard configuration path saved","success")):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message),this.changed=!1,this.updating=!1}))}}},Kt={class:"card"},Ft={class:"card-header"},Lt={class:"my-2"},Et={class:"card-body"},Mt={class:"form-group"},Ut=["for"],Wt={class:"d-flex gap-2 align-items-start"},Nt={class:"flex-grow-1"},Rt=["id","disabled"],Gt={class:"invalid-feedback fw-bold"},Yt=["disabled"],Ht={key:0,class:"bi bi-save2-fill"},Bt={key:1,class:"spinner-border spinner-border-sm"},jt={key:0,class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block mt-1 mb-2"};function zt(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",Kt,[t("div",Ft,[t("h6",Lt,[o(i,{t:"Path"})])]),t("div",Et,[t("div",Mt,[t("label",{for:this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[o(i,{t:this.title},null,8,["t"])])])],8,Ut),t("div",Wt,[t("div",Nt,[b(t("input",{type:"text",class:w(["form-control rounded-3",{"is-invalid":this.showInvalidFeedback,"is-valid":this.isValid}]),id:this.uuid,"onUpdate:modelValue":e[0]||(e[0]=a=>this.value=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),disabled:this.updating},null,42,Rt),[[f,this.value]]),t("div",Gt,x(this.invalidFeedback),1)]),t("button",{onClick:e[2]||(e[2]=a=>this.useValidation()),disabled:!this.changed,class:"ms-auto btn rounded-3 border-success-subtle bg-success-subtle text-success-emphasis"},[this.updating?(n(),l("span",Bt)):(n(),l("i",Ht))],8,Yt)]),c.warning?(n(),l("div",jt,[t("small",null,[e[3]||(e[3]=t("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),o(i,{t:c.warningText},null,8,["t"])])])):_("",!0)])])])}const Ot=$(Vt,[["render",zt]]),qt={name:"dashboardTheme",components:{LocaleText:g},setup(){return{dashboardConfigurationStore:y()}},methods:{async switchTheme(s){await v("/api/updateDashboardConfigurationItem",{section:"Server",key:"dashboard_theme",value:s},e=>{e.status&&(this.dashboardConfigurationStore.Configuration.Server.dashboard_theme=s)})}}},Qt={class:"text-muted mb-1 d-block"},Jt={class:"d-flex gap-1"};function Xt(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",null,[t("small",Qt,[t("strong",null,[o(i,{t:"Theme"})])]),t("div",Jt,[t("button",{class:w(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration.Server.dashboard_theme==="light"}]),onClick:e[0]||(e[0]=a=>this.switchTheme("light"))},[e[2]||(e[2]=t("i",{class:"bi bi-sun-fill me-2"},null,-1)),o(i,{t:"Light"})],2),t("button",{class:w(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration.Server.dashboard_theme==="dark"}]),onClick:e[1]||(e[1]=a=>this.switchTheme("dark"))},[e[3]||(e[3]=t("i",{class:"bi bi-moon-fill me-2"},null,-1)),o(i,{t:"Dark"})],2)])])}const Zt=$(qt,[["render",Xt]]),te={name:"dashboardSettingsInputIPAddressAndPort",props:{},setup(){const s=y(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{app_ip:"",app_port:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.app_ip=this.store.Configuration.Server.app_ip,this.app_port=this.store.Configuration.Server.app_port},methods:{async useValidation(){this.changed&&await v("/api/updateDashboardConfigurationItem",{section:"Server",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message)})}}},ee={class:"invalid-feedback d-block mt-0"},se={class:"row"},ae={class:"form-group mb-2 col-sm"},ie=["for"],oe=["id"],ne={class:"form-group col-sm"},le=["for"],de=["id"];function re(s,e,c,h,r,p){return n(),l("div",null,[t("div",ee,x(this.invalidFeedback),1),t("div",se,[t("div",ae,[t("label",{for:"app_ip_"+this.uuid,class:"text-muted mb-1"},e[2]||(e[2]=[t("strong",null,[t("small",null,"Dashboard IP Address")],-1)]),8,ie),b(t("input",{type:"text",class:"form-control mb-2",id:"app_ip_"+this.uuid,"onUpdate:modelValue":e[0]||(e[0]=i=>this.app_ip=i)},null,8,oe),[[f,this.app_ip]]),e[3]||(e[3]=t("div",{class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block"},[t("small",null,[t("i",{class:"bi bi-exclamation-triangle-fill me-2"}),t("code",null,"0.0.0.0"),I(" means it can be access by anyone with your server IP Address.")])],-1))]),t("div",ne,[t("label",{for:"app_port_"+this.uuid,class:"text-muted mb-1"},e[4]||(e[4]=[t("strong",null,[t("small",null,"Dashboard Port")],-1)]),8,le),b(t("input",{type:"text",class:"form-control mb-2",id:"app_port_"+this.uuid,"onUpdate:modelValue":e[1]||(e[1]=i=>this.app_port=i)},null,8,de),[[f,this.app_port]])])]),e[5]||(e[5]=t("button",{class:"btn btn-success btn-sm fw-bold rounded-3"},[t("i",{class:"bi bi-floppy-fill me-2"}),I("Update Dashboard Settings & Restart ")],-1))])}const ue=$(te,[["render",re]]),ce={name:"newDashboardAPIKey",components:{LocaleText:g,VueDatePicker:Q},data(){return{newKeyData:{ExpiredAt:C().add(7,"d").format("YYYY-MM-DD HH:mm:ss"),neverExpire:!1},submitting:!1}},setup(){return{store:y()}},mounted(){console.log(this.newKeyData.ExpiredAt)},methods:{submitNewAPIKey(){this.submitting=!0,v("/api/newDashboardAPIKey",this.newKeyData,s=>{s.status?(this.$emit("created",s.data),this.store.newMessage("Server","API Key created","success"),this.$emit("close")):this.store.newMessage("Server",s.message,"danger"),this.submitting=!1})},fixDate(s){return console.log(C(s).format("YYYY-MM-DDTHH:mm:ss")),C(s).format("YYYY-MM-DDTHH:mm:ss")},parseTime(s){s?this.newKeyData.ExpiredAt=C(s).format("YYYY-MM-DD HH:mm:ss"):this.newKeyData.ExpiredAt=void 0}}},he={class:"position-absolute w-100 h-100 top-0 start-0 rounded-bottom-3 p-3 d-flex",style:{"background-color":"#00000060","backdrop-filter":"blur(3px)"}},me={class:"card m-auto rounded-3 mt-5"},pe={class:"card-header bg-transparent d-flex align-items-center gap-2 border-0 p-4 pb-0"},ge={class:"mb-0"},be={class:"card-body d-flex gap-2 p-4 flex-column"},_e={class:"text-muted"},fe={class:"d-flex align-items-center gap-2"},ve={class:"form-check"},ye=["disabled"],we={class:"form-check-label",for:"neverExpire"},$e={key:0,class:"bi bi-check-lg me-2"};function ke(s,e,c,h,r,p){const i=m("LocaleText"),a=m("VueDatePicker");return n(),l("div",he,[t("div",me,[t("div",pe,[t("h6",ge,[o(i,{t:"Create API Key"})]),t("button",{type:"button",class:"btn-close ms-auto",onClick:e[0]||(e[0]=u=>this.$emit("close"))})]),t("div",be,[t("small",_e,[o(i,{t:"When should this API Key expire?"})]),t("div",fe,[o(a,{is24:!0,"min-date":new Date,"model-value":this.newKeyData.ExpiredAt,"onUpdate:modelValue":this.parseTime,"time-picker-inline":"",format:"yyyy-MM-dd HH:mm:ss","preview-format":"yyyy-MM-dd HH:mm:ss",clearable:!1,disabled:this.newKeyData.neverExpire||this.submitting,dark:this.store.Configuration.Server.dashboard_theme==="dark"},null,8,["min-date","model-value","onUpdate:modelValue","disabled","dark"])]),t("div",ve,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=u=>this.newKeyData.neverExpire=u),id:"neverExpire",disabled:this.submitting},null,8,ye),[[L,this.newKeyData.neverExpire]]),t("label",we,[o(i,{t:"Never Expire"}),e[3]||(e[3]=I(" (")),e[4]||(e[4]=t("i",{class:"bi bi-emoji-grimace-fill me-2"},null,-1)),o(i,{t:"Don't think that's a good idea"}),e[5]||(e[5]=I(") "))])]),t("button",{class:w(["ms-auto btn bg-success-subtle text-success-emphasis border-1 border-success-subtle rounded-3 shadow-sm",{disabled:this.submitting}]),onClick:e[2]||(e[2]=u=>this.submitNewAPIKey())},[this.submitting?_("",!0):(n(),l("i",$e)),this.submitting?(n(),k(i,{key:1,t:"Creating..."})):(n(),k(i,{key:2,t:"Create"}))],2)])])])}const xe=$(ce,[["render",ke]]),De={name:"dashboardAPIKey",components:{LocaleText:g},props:{apiKey:Object},setup(){return{store:y()}},data(){return{confirmDelete:!1}},methods:{deleteAPIKey(){v("/api/deleteDashboardAPIKey",{Key:this.apiKey.Key},s=>{s.status?(this.$emit("deleted",s.data),this.store.newMessage("Server","API Key deleted","success")):this.store.newMessage("Server",s.message,"danger")})}}},Ie={class:"card rounded-3 shadow-sm"},Se={key:0,class:"card-body d-flex gap-3 align-items-center apiKey-card-body"},Pe={class:"d-flex align-items-center gap-2"},Ae={class:"text-muted"},Ce={style:{"word-break":"break-all"}},Te={class:"d-flex align-items-center gap-2 ms-auto"},Ve={class:"text-muted"},Ke={key:0,class:"card-body d-flex gap-3 align-items-center justify-content-end"};function Fe(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",Ie,[this.confirmDelete?(n(),l(P,{key:1},[this.store.getActiveCrossServer()?_("",!0):(n(),l("div",Ke,[o(i,{t:"Are you sure to delete this API key?"}),t("a",{role:"button",class:"btn btn-sm bg-success-subtle text-success-emphasis rounded-3",onClick:e[1]||(e[1]=a=>this.deleteAPIKey())},e[4]||(e[4]=[t("i",{class:"bi bi-check-lg"},null,-1)])),t("a",{role:"button",class:"btn btn-sm bg-secondary-subtle text-secondary-emphasis rounded-3",onClick:e[2]||(e[2]=a=>this.confirmDelete=!1)},e[5]||(e[5]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]))],64)):(n(),l("div",Se,[t("div",Pe,[t("small",Ae,[o(i,{t:"Key"})]),t("span",Ce,x(this.apiKey.Key),1)]),t("div",Te,[t("small",Ve,[o(i,{t:"Expire At"})]),this.apiKey.ExpiredAt?_("",!0):(n(),k(i,{key:0,t:"Never Expire"})),t("span",null,x(this.apiKey.ExpiredAt),1)]),this.store.getActiveCrossServer()?_("",!0):(n(),l("a",{key:0,role:"button",class:"btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",onClick:e[0]||(e[0]=a=>this.confirmDelete=!0)},e[3]||(e[3]=[t("i",{class:"bi bi-trash-fill"},null,-1)])))]))])}const Le=$(De,[["render",Fe],["__scopeId","data-v-a76253c8"]]),Ee={name:"dashboardAPIKeys",components:{LocaleText:g,DashboardAPIKey:Le,NewDashboardAPIKey:xe},setup(){return{store:y()}},data(){return{value:this.store.Configuration.Server.dashboard_api_key,apiKeys:[],newDashboardAPIKey:!1}},methods:{async toggleDashboardAPIKeys(){await v("/api/updateDashboardConfigurationItem",{section:"Server",key:"dashboard_api_key",value:this.value},s=>{s.status?(this.store.Configuration.Peers[this.targetData]=this.value,this.store.newMessage("Server",`API Keys function is successfully ${this.value?"enabled":"disabled"}`,"success")):(this.value=this.store.Configuration.Peers[this.targetData],this.store.newMessage("Server",`API Keys function is failed to ${this.value?"enabled":"disabled"}`,"danger"))})}},watch:{value:{immediate:!0,handler(s){s?E("/api/getDashboardAPIKeys",{},e=>{e.status?this.apiKeys=e.data:(this.apiKeys=[],this.store.newMessage("Server",e.message,"danger"))}):this.apiKeys=[]}}}},Me={class:"card rounded-3"},Ue={class:"my-2"},We={key:0,class:"form-check form-switch ms-auto"},Ne={class:"form-check-label",for:"allowAPIKeysSwitch"},Re={key:0,class:"card-body position-relative d-flex flex-column gap-2"},Ge={key:1,class:"card",style:{height:"300px"}},Ye={class:"card-body d-flex text-muted"},He={class:"m-auto"},Be={key:2,class:"d-flex flex-column gap-2 position-relative",style:{"min-height":"300px"}};function je(s,e,c,h,r,p){const i=m("LocaleText"),a=m("DashboardAPIKey"),u=m("NewDashboardAPIKey");return n(),l("div",Me,[t("div",{class:w(["card-header d-flex align-items-center",{"border-bottom-0 rounded-3":!this.value}])},[t("h6",Ue,[o(i,{t:"API Keys"})]),this.store.getActiveCrossServer()?_("",!0):(n(),l("div",We,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=d=>this.value=d),onChange:e[1]||(e[1]=d=>this.toggleDashboardAPIKeys()),role:"switch",id:"allowAPIKeysSwitch"},null,544),[[L,this.value]]),t("label",Ne,[this.value?(n(),k(i,{key:0,t:"Enabled"})):(n(),k(i,{key:1,t:"Disabled"}))])]))],2),this.value?(n(),l("div",Re,[this.store.getActiveCrossServer()?_("",!0):(n(),l("button",{key:0,class:"btn bg-primary-subtle text-primary-emphasis border-1 border-primary-subtle rounded-3 shadow-sm",onClick:e[2]||(e[2]=d=>this.newDashboardAPIKey=!0)},[e[6]||(e[6]=t("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),o(i,{t:"API Key"})])),this.apiKeys.length===0?(n(),l("div",Ge,[t("div",Ye,[t("span",He,[o(i,{t:"No WGDashboard API Key"})])])])):(n(),l("div",Be,[o(j,{name:"apiKey"},{default:F(()=>[(n(!0),l(P,null,V(this.apiKeys,d=>(n(),k(a,{apiKey:d,key:d.Key,onDeleted:e[3]||(e[3]=A=>this.apiKeys=A)},null,8,["apiKey"]))),128))]),_:1})])),o(U,{name:"zoomReversed"},{default:F(()=>[this.newDashboardAPIKey?(n(),k(u,{key:0,onCreated:e[4]||(e[4]=d=>this.apiKeys=d),onClose:e[5]||(e[5]=d=>this.newDashboardAPIKey=!1)})):_("",!0)]),_:1})])):_("",!0)])}const ze=$(Ee,[["render",je],["__scopeId","data-v-100ee9f9"]]),Oe={name:"accountSettingsMFA",components:{LocaleText:g},setup(){const s=y(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{status:!1}},mounted(){this.status=this.store.Configuration.Account.enable_totp},methods:{async resetMFA(){await v("/api/updateDashboardConfigurationItem",{section:"Account",key:"totp_verified",value:"false"},async s=>{await v("/api/updateDashboardConfigurationItem",{section:"Account",key:"enable_totp",value:"false"},e=>{e.status&&this.$router.push("/2FASetup")})})}}},qe={class:"d-flex align-items-center"},Qe={class:"form-check form-switch"},Je={for:"allowMFAKeysSwitch"};function Xe(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",null,[t("div",qe,[t("div",Qe,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=a=>this.status=a),role:"switch",id:"allowMFAKeysSwitch"},null,512),[[L,this.status]]),t("label",Je,[this.status?(n(),k(i,{key:0,t:"Enabled"})):(n(),k(i,{key:1,t:"Disabled"}))])]),this.status?(n(),l("button",{key:0,class:"btn bg-warning-subtle text-warning-emphasis border-1 border-warning-subtle ms-auto rounded-3 shadow-sm",onClick:e[1]||(e[1]=a=>this.resetMFA())},[e[2]||(e[2]=t("i",{class:"bi bi-shield-lock-fill me-2"},null,-1)),this.store.Configuration.Account.totp_verified?(n(),k(i,{key:0,t:"Reset"})):(n(),k(i,{key:1,t:"Setup"})),e[3]||(e[3]=I(" MFA "))])):_("",!0)])])}const Ze=$(Oe,[["render",Xe]]),ts={name:"dashboardLanguage",components:{LocaleText:g},setup(){return{store:y()}},data(){return{languages:void 0}},mounted(){E("/api/locale/available",{},s=>{this.languages=s.data})},methods:{changeLanguage(s){v("/api/locale/update",{lang_id:s},e=>{e.status?(this.store.Configuration.Server.dashboard_language=s,this.store.Locale=e.data):this.store.newMessage("Server","WGDashboard language update failed","danger")})}},computed:{currentLanguage(){let s=this.store.Configuration.Server.dashboard_language;return this.languages.find(e=>e.lang_id===s)}}},es={class:"text-muted d-block mb-1"},ss={class:"d-flex gap-2"},as={class:"dropdown w-100"},is=["disabled"],os={key:1},ns={class:"dropdown-menu rounded-3 shadow"},ls=["onClick"],ds={class:"me-auto mb-0"},rs={class:"d-block",style:{"font-size":"0.8rem"}},us={key:0,class:"bi bi-check text-primary fs-5"};function cs(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",null,[t("small",es,[t("strong",null,[o(i,{t:"Language"})])]),t("div",ss,[t("div",as,[t("button",{class:"btn bg-primary-subtle text-primary-emphasis dropdown-toggle w-100 rounded-3",disabled:!this.languages,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[this.languages?(n(),l("span",os,x(p.currentLanguage?.lang_name_localized),1)):(n(),k(i,{key:0,t:"Loading..."}))],8,is),t("ul",ns,[(n(!0),l(P,null,V(this.languages,a=>(n(),l("li",null,[t("a",{class:"dropdown-item d-flex align-items-center",role:"button",onClick:u=>this.changeLanguage(a.lang_id)},[t("p",ds,[I(x(a.lang_name_localized)+" ",1),t("small",rs,x(a.lang_name),1)]),p.currentLanguage?.lang_id===a.lang_id?(n(),l("i",us)):_("",!0)],8,ls)]))),256))])])])])}const hs=$(ts,[["render",cs],["__scopeId","data-v-0f26916d"]]),ms={name:"dashboardIPPortInput",components:{LocaleText:g},setup(){return{store:y()}},data(){return{ipAddress:"",port:0,invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.ipAddress=this.store.Configuration.Server.app_ip,this.port=this.store.Configuration.Server.app_port},methods:{async useValidation(s,e,c){this.changed&&(this.updating=!0,await v("/api/updateDashboardConfigurationItem",{section:"Server",key:e,value:c},h=>{h.status?(s.target.classList.add("is-valid"),this.showInvalidFeedback=!1,this.store.Configuration.Server[e]=c,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{s.target.classList.remove("is-valid")},5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=h.message),this.changed=!1,this.updating=!1}))}}},ps={class:"row g-2"},gs={class:"col-sm"},bs={class:"form-group"},_s={for:"input_dashboard_ip",class:"text-muted mb-1"},fs=["disabled"],vs={class:"invalid-feedback"},ys={class:"col-sm"},ws={class:"form-group"},$s={for:"input_dashboard_ip",class:"text-muted mb-1"},ks=["disabled"],xs={class:"invalid-feedback"},Ds={class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block mb-2 mt-2"};function Is(s,e,c,h,r,p){const i=m("LocaleText");return n(),l("div",null,[t("div",ps,[t("div",gs,[t("div",bs,[t("label",_s,[t("strong",null,[t("small",null,[o(i,{t:"IP Address / Hostname"})])])]),b(t("input",{type:"text",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),id:"input_dashboard_ip","onUpdate:modelValue":e[0]||(e[0]=a=>this.ipAddress=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),onBlur:e[2]||(e[2]=a=>p.useValidation(a,"app_ip",this.ipAddress)),disabled:this.updating},null,42,fs),[[f,this.ipAddress]]),t("div",vs,x(this.invalidFeedback),1)])]),t("div",ys,[t("div",ws,[t("label",$s,[t("strong",null,[t("small",null,[o(i,{t:"Listen Port"})])])]),b(t("input",{type:"number",class:w(["form-control",{"is-invalid":r.showInvalidFeedback,"is-valid":r.isValid}]),id:"input_dashboard_ip","onUpdate:modelValue":e[3]||(e[3]=a=>this.port=a),onKeydown:e[4]||(e[4]=a=>this.changed=!0),onBlur:e[5]||(e[5]=a=>p.useValidation(a,"app_port",this.port)),disabled:this.updating},null,42,ks),[[f,this.port]]),t("div",xs,x(this.invalidFeedback),1)])])]),t("div",Ds,[t("small",null,[e[6]||(e[6]=t("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),o(i,{t:"Manual restart of WGDashboard is needed to apply changes on IP Address and Listen Port"})])])])}const Ss=$(ms,[["render",Is]]),Ps={class:"card rounded-3"},As={class:"card-header"},Cs={class:"my-2"},Ts={class:"card-body d-flex gap-2"},Vs={class:"list-group w-100"},Ks=["onClick"],Fs={__name:"dashboardSettingsWireguardConfigurationAutostart",setup(s){const e=y(),c=M(),h=T(e.Configuration.WireGuardConfiguration.autostart),r=z(()=>c.Configurations.map(a=>a.Name)),p=async()=>{await v("/api/updateDashboardConfigurationItem",{section:"WireGuardConfiguration",key:"autostart",value:h.value},async a=>{a.status?(e.newMessage("Server","Start up configurations saved","success"),h.value=a.data):e.newMessage("Server","Start up configurations failed to save","danger")})},i=a=>{h.value.includes(a)?h.value=h.value.filter(u=>u!==a):h.value.push(a),p()};return(a,u)=>(n(),l("div",Ps,[t("div",As,[t("h6",Cs,[o(g,{t:"Toggle When Start Up"})])]),t("div",Ts,[t("div",Vs,[(n(!0),l(P,null,V(r.value,d=>(n(),l("button",{type:"button",key:d,onClick:A=>i(d),class:"list-group-item list-group-item-action py-2 w-100 d-flex align-items-center"},[t("samp",null,x(d),1),t("i",{class:w(["ms-auto",[h.value.includes(d)?"bi-check-circle-fill":"bi-circle"]])},null,2)],8,Ks))),128))])])]))}},Ls=$(Fs,[["__scopeId","data-v-4aa2aed9"]]),Es={class:"card"},Ms={class:"card-header"},Us={class:"my-2 d-flex"},Ws={key:0,class:"text-success ms-auto"},Ns={class:"card-body"},Rs={class:"row gx-2 gy-2"},Gs={class:"col-12 col-lg-4"},Ys={class:"form-group"},Hs={for:"server",class:"text-muted mb-1"},Bs={class:"col-12 col-lg-4"},js={class:"form-group"},zs={for:"port",class:"text-muted mb-1"},Os={class:"col-12 col-lg-4"},qs={class:"form-group"},Qs={for:"encryption",class:"text-muted mb-1"},Js={value:"NOTLS"},Xs={class:"col-12 col-lg-4"},Zs={class:"form-group"},ta={for:"username",class:"text-muted mb-1"},ea={class:"col-12 col-lg-4"},sa={class:"form-group"},aa={for:"email_password",class:"text-muted mb-1"},ia={class:"col-12 col-lg-4"},oa={class:"form-group"},na={for:"send_from",class:"text-muted mb-1"},la={key:0},da=["disabled"],ra=["disabled"],ua={key:0,class:"bi bi-send me-2"},ca={key:1,class:"spinner-border spinner-border-sm me-2"},ha={__name:"dashboardEmailSettings",setup(s){const e=y();O(()=>{p(),document.querySelectorAll("#emailAccount input, #emailAccount select").forEach(a=>{a.addEventListener("change",async()=>{let u=a.attributes.getNamedItem("id").value;await v("/api/updateDashboardConfigurationItem",{section:"Email",key:u,value:a.value},d=>{d.status?(a.classList.remove("is-invalid"),a.classList.add("is-valid")):(a.classList.remove("is-valid"),a.classList.add("is-invalid")),p()})})})});const c=T(!1),h=T(""),r=T(!1),p=async()=>{await E("/api/email/ready",{},a=>{c.value=a.status})},i=async()=>{r.value=!0,await v("/api/email/send",{Receiver:h.value,Subject:"WGDashboard Testing Email",Body:"Test 1, 2, 3! Hello World :)"},a=>{a.status?e.newMessage("Server","Test email sent successfully!","success"):e.newMessage("Server",`Test email sent failed! Reason: ${a.message}`,"danger"),r.value=!1})};return(a,u)=>(n(),l("div",Es,[t("div",Ms,[t("h6",Us,[o(g,{t:"Email Account"}),c.value?(n(),l("span",Ws,[u[9]||(u[9]=t("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),o(g,{t:"Ready"})])):_("",!0)])]),t("div",Ns,[t("form",{onSubmit:u[6]||(u[6]=d=>d.preventDefault(d)),id:"emailAccount"},[t("div",Rs,[t("div",Gs,[t("div",Ys,[t("label",Hs,[t("strong",null,[t("small",null,[o(g,{t:"Server"})])])]),b(t("input",{id:"server","onUpdate:modelValue":u[0]||(u[0]=d=>D(e).Configuration.Email.server=d),type:"text",class:"form-control"},null,512),[[f,D(e).Configuration.Email.server]])])]),t("div",Bs,[t("div",js,[t("label",zs,[t("strong",null,[t("small",null,[o(g,{t:"Port"})])])]),b(t("input",{id:"port","onUpdate:modelValue":u[1]||(u[1]=d=>D(e).Configuration.Email.port=d),type:"text",class:"form-control"},null,512),[[f,D(e).Configuration.Email.port]])])]),t("div",Os,[t("div",qs,[t("label",Qs,[t("strong",null,[t("small",null,[o(g,{t:"Encryption"})])])]),b(t("select",{class:"form-select","onUpdate:modelValue":u[2]||(u[2]=d=>D(e).Configuration.Email.encryption=d),id:"encryption"},[u[10]||(u[10]=t("option",{value:"STARTTLS"}," STARTTLS ",-1)),t("option",Js,[o(g,{t:"No Encryption"})])],512),[[q,D(e).Configuration.Email.encryption]])])]),t("div",Xs,[t("div",Zs,[t("label",ta,[t("strong",null,[t("small",null,[o(g,{t:"Username"})])])]),b(t("input",{id:"username","onUpdate:modelValue":u[3]||(u[3]=d=>D(e).Configuration.Email.username=d),type:"text",class:"form-control"},null,512),[[f,D(e).Configuration.Email.username]])])]),t("div",ea,[t("div",sa,[t("label",aa,[t("strong",null,[t("small",null,[o(g,{t:"Password"})])])]),b(t("input",{id:"email_password","onUpdate:modelValue":u[4]||(u[4]=d=>D(e).Configuration.Email.email_password=d),type:"password",class:"form-control"},null,512),[[f,D(e).Configuration.Email.email_password]])])]),t("div",ia,[t("div",oa,[t("label",na,[t("strong",null,[t("small",null,[o(g,{t:"Send From"})])])]),b(t("input",{id:"send_from","onUpdate:modelValue":u[5]||(u[5]=d=>D(e).Configuration.Email.send_from=d),type:"text",class:"form-control"},null,512),[[f,D(e).Configuration.Email.send_from]])])])])],32),c.value?(n(),l("hr",la)):_("",!0),c.value?(n(),l("form",{key:1,onSubmit:u[8]||(u[8]=d=>{d.preventDefault(),i()}),class:"input-group mb-3"},[b(t("input",{type:"email",class:"form-control rounded-start-3","onUpdate:modelValue":u[7]||(u[7]=d=>h.value=d),disabled:r.value,placeholder:"Test Email Receiver"},null,8,da),[[f,h.value]]),t("button",{class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-end-3",type:"submit",value:"Submit",disabled:h.value.length===0||r.value,id:"button-addon2"},[r.value?(n(),l("span",ca,u[11]||(u[11]=[t("span",{class:"visually-hidden"},"Loading...",-1)]))):(n(),l("i",ua)),o(g,{t:r.value?"Sending...":"Send Test Email"},null,8,["t"])],8,ra)],32)):_("",!0)])]))}},ma={name:"settings",methods:{ipV46RegexCheck:ot},components:{DashboardEmailSettings:ha,DashboardSettingsWireguardConfigurationAutostart:Ls,DashboardIPPortInput:Ss,DashboardLanguage:hs,LocaleText:g,AccountSettingsMFA:Ze,DashboardAPIKeys:ze,DashboardSettingsInputIPAddressAndPort:ue,DashboardTheme:Zt,DashboardSettingsInputWireguardConfigurationPath:Ot,AccountSettingsInputPassword:Tt,AccountSettingsInputUsername:ht,PeersDefaultSettingsInput:it},setup(){return{dashboardConfigurationStore:y()}},data(){return{activeTab:"WGDashboard",tabs:[{id:"WGDashboard",title:"WGDashboard Settings"},{id:"Peers",title:"Peers Settings"},{id:"WireGuardConfiguration",title:"WireGuard Configuration Settings"}]}}},pa={class:"mt-md-5 mt-3 text-body mb-3"},ga={class:"container-md d-flex flex-column gap-4"},ba={class:"nav nav-pills nav-justified align-items-center gap-2"},_a={class:"nav-item"},fa=["onClick"],va={class:"my-2"},ya={key:0,class:"d-flex gap-3 flex-column"},wa={key:1,class:"d-flex gap-3 flex-column"},$a={class:"card rounded-3"},ka={class:"card-header"},xa={class:"my-2"},Da={class:"card-body"},Ia={key:2,class:"d-flex gap-3 flex-column"},Sa={class:"card rounded-3"},Pa={class:"card-header"},Aa={class:"my-2"},Ca={class:"card-body"},Ta={class:"row g-2"},Va={class:"col-sm"},Ka={class:"col-sm"},Fa={class:"card"},La={class:"card-header"},Ea={class:"my-2"},Ma={class:"card-body"},Ua={class:"card"},Wa={class:"card-header"},Na={class:"my-2"},Ra={class:"card-body d-flex flex-column gap-3"},Ga={class:"card"},Ya={class:"card-header"},Ha={class:"my-2"},Ba={class:"card-body"};function ja(s,e,c,h,r,p){const i=m("LocaleText"),a=m("DashboardSettingsInputWireguardConfigurationPath"),u=m("DashboardSettingsWireguardConfigurationAutostart"),d=m("PeersDefaultSettingsInput"),A=m("DashboardTheme"),W=m("DashboardLanguage"),N=m("DashboardIPPortInput"),R=m("AccountSettingsInputUsername"),G=m("AccountSettingsInputPassword"),Y=m("AccountSettingsMFA"),H=m("DashboardAPIKeys"),B=m("DashboardEmailSettings");return n(),l("div",pa,[t("div",ga,[t("div",null,[t("ul",ba,[(n(!0),l(P,null,V(this.tabs,K=>(n(),l("li",_a,[t("a",{class:w(["nav-link rounded-3",{active:this.activeTab===K.id}]),onClick:za=>this.activeTab=K.id,role:"button"},[t("h6",va,[o(i,{t:K.title},null,8,["t"])])],10,fa)]))),256))]),e[1]||(e[1]=t("hr",null,null,-1)),t("div",null,[o(U,{name:"fade2",mode:"out-in"},{default:F(()=>[r.activeTab==="WireGuardConfiguration"?(n(),l("div",ya,[o(a,{targetData:"wg_conf_path",title:"Configurations Directory",warning:!0,"warning-text":"Remember to remove / at the end of your path. e.g /etc/wireguard"}),o(u)])):r.activeTab==="Peers"?(n(),l("div",wa,[t("div",$a,[t("div",ka,[t("h6",xa,[o(i,{t:"Peer Default Settings"})])]),t("div",Da,[t("div",null,[o(d,{targetData:"peer_global_dns",title:"DNS"}),o(d,{targetData:"peer_endpoint_allowed_ip",title:"Endpoint Allowed IPs"}),o(d,{targetData:"peer_mtu",title:"MTU"}),o(d,{targetData:"peer_keep_alive",title:"Persistent Keepalive"}),o(d,{targetData:"remote_endpoint",title:"Peer Remote Endpoint",warning:!0,warningText:"This will be changed globally, and will be apply to all peer's QR code and configuration file."})])])])])):r.activeTab==="WGDashboard"?(n(),l("div",Ia,[t("div",Sa,[t("div",Pa,[t("h6",Aa,[o(i,{t:"Appearance"})])]),t("div",Ca,[t("div",Ta,[t("div",Va,[o(A)]),t("div",Ka,[o(W)])])])]),t("div",Fa,[t("div",La,[t("h6",Ea,[o(i,{t:"Dashboard IP Address & Listen Port"})])]),t("div",Ma,[o(N)])]),t("div",Ua,[t("div",Wa,[t("h6",Na,[o(i,{t:"Account Settings"})])]),t("div",Ra,[t("div",null,[o(R,{targetData:"username",title:"Username"})]),e[0]||(e[0]=t("hr",null,null,-1)),t("div",null,[o(G,{targetData:"password"})])])]),t("div",Ga,[t("div",Ya,[t("h6",Ha,[o(i,{t:"Multi-Factor Authentication (MFA)"})])]),t("div",Ba,[this.dashboardConfigurationStore.getActiveCrossServer()?_("",!0):(n(),k(Y,{key:0}))])]),o(H),o(B)])):_("",!0)]),_:1})])])])])}const Xa=$(ma,[["render",ja]]);export{Xa as default};
