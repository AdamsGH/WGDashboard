import{_ as Y,u as F,r as v,$ as R,D as L,p as P,a as r,c,b as e,d as a,w as C,e as y,T as w,t as B,f as N,A as T,n as D,z as M,g as $,o as V,F as W,h as z,i as H,k as j}from"./index-Dv7fDh6w.js";import{d as A}from"./dayjs.min-Be5JU_dU.js";import{L as n}from"./localeText-C-3_pE2W.js";const G={class:"card my-0 rounded-3"},I={class:"card-body position-relative"},E={key:0,class:"position-absolute w-100 h-100 confirmationContainer start-0 top-0 rounded-3 d-flex p-2"},q={class:"m-auto"},J={class:"d-flex gap-2 align-items-center justify-content-center"},K=["disabled"],O=["disabled"],Q={key:0,class:"position-absolute w-100 h-100 confirmationContainer start-0 top-0 rounded-3 d-flex p-2"},U={class:"m-auto"},X={class:"d-flex gap-2 align-items-center justify-content-center"},Z=["disabled"],ee=["disabled"],se={class:"d-flex gap-3"},te={class:"d-flex flex-column"},ae={class:"text-muted"},oe={class:"d-flex flex-column"},ne={class:"text-muted"},le={class:"d-flex gap-2 align-items-center ms-auto"},ie={class:"card rounded-3"},re={key:0,class:"card-body"},de=["value"],ue={class:"d-flex"},ce={__name:"backup",props:["b","delay"],emits:["refresh","refreshPeersList"],setup(m,{emit:_}){F(u=>({"0c799ec6":S.value}));const d=m,i=v(!1),l=v(!1),g=R(),k=_,f=L(),o=v(!1),t=()=>{o.value=!0,M("/api/deleteWireguardConfigurationBackup",{configurationName:g.params.id,backupFileName:d.b.filename},u=>{o.value=!1,u.status?(k("refresh"),f.newMessage("Server","Backup deleted","success")):f.newMessage("Server","Backup failed to delete","danger")})},p=()=>{o.value=!0,M("/api/restoreWireguardConfigurationBackup",{configurationName:g.params.id,backupFileName:d.b.filename},u=>{o.value=!1,l.value=!1,u.status?(k("refresh"),f.newMessage("Server","Backup restored with "+d.b.filename,"success")):f.newMessage("Server","Backup failed to restore","danger")})},h=()=>{$("/api/downloadWireguardConfigurationBackup",{configurationName:g.params.id,backupFileName:d.b.filename},u=>{u.status&&window.open(`/fileDownload?file=${u.data}`,"_blank")})},S=P(()=>d.delay+"s"),x=v(!1);return(u,s)=>(r(),c("div",G,[e("div",I,[a(w,{name:"zoomReversed"},{default:C(()=>[i.value?(r(),c("div",E,[e("div",q,[e("h5",null,[a(n,{t:"Are you sure to delete this backup?"})]),e("div",J,[e("button",{class:"btn btn-danger rounded-3",disabled:o.value,onClick:s[0]||(s[0]=b=>t())},[a(n,{t:"Yes"})],8,K),e("button",{onClick:s[1]||(s[1]=b=>i.value=!1),disabled:o.value,class:"btn bg-secondary-subtle text-secondary-emphasis border-secondary-subtle rounded-3"},[a(n,{t:"No"})],8,O)])])])):y("",!0)]),_:1}),a(w,{name:"zoomReversed"},{default:C(()=>[l.value?(r(),c("div",Q,[e("div",U,[e("h5",null,[a(n,{t:"Are you sure to restore this backup?"})]),e("div",X,[e("button",{disabled:o.value,onClick:s[2]||(s[2]=b=>p()),class:"btn btn-success rounded-3"},[a(n,{t:"Yes"})],8,Z),e("button",{onClick:s[3]||(s[3]=b=>l.value=!1),disabled:o.value,class:"btn bg-secondary-subtle text-secondary-emphasis border-secondary-subtle rounded-3"},[a(n,{t:"No"})],8,ee)])])])):y("",!0)]),_:1}),e("div",se,[e("div",te,[e("small",ae,[a(n,{t:"Backup"})]),e("samp",null,B(m.b.filename),1)]),e("div",oe,[e("small",ne,[a(n,{t:"Backup Date"})]),N(" "+B(T(A)(m.b.backupDate,"YYYYMMDDHHmmss").format("YYYY-MM-DD HH:mm:ss")),1)]),e("div",le,[e("button",{onClick:s[4]||(s[4]=b=>h()),class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-3 btn-sm"},s[8]||(s[8]=[e("i",{class:"bi bi-download"},null,-1)])),e("button",{onClick:s[5]||(s[5]=b=>l.value=!0),class:"btn bg-warning-subtle text-warning-emphasis border-warning-subtle rounded-3 btn-sm"},s[9]||(s[9]=[e("i",{class:"bi bi-clock-history"},null,-1)])),e("button",{onClick:s[6]||(s[6]=b=>i.value=!0),class:"btn bg-danger-subtle text-danger-emphasis border-danger-subtle rounded-3 btn-sm"},s[10]||(s[10]=[e("i",{class:"bi bi-trash-fill"},null,-1)]))])]),s[14]||(s[14]=e("hr",null,null,-1)),e("div",ie,[e("a",{role:"button",class:D(["card-header d-flex text-decoration-none align-items-center",{"border-bottom-0":!x.value}]),style:{cursor:"pointer"},onClick:s[7]||(s[7]=b=>x.value=!x.value)},[e("small",null,[s[11]||(s[11]=N(".conf ")),a(n,{t:"File"})]),s[12]||(s[12]=e("i",{class:"bi bi-chevron-down ms-auto"},null,-1))],2),x.value?(r(),c("div",re,[e("textarea",{class:"form-control rounded-3",value:m.b.content,disabled:"",style:{height:"300px","font-family":"var(--bs-font-monospace),sans-serif !important"}},null,8,de)])):y("",!0)]),s[15]||(s[15]=e("hr",null,null,-1)),e("div",ue,[e("span",null,[s[13]||(s[13]=e("i",{class:"bi bi-database me-1"},null,-1)),a(n,{t:"Database File"})]),e("i",{class:D(["bi ms-auto",[m.b.database?"text-success bi-check-circle-fill":"text-danger bi-x-circle-fill"]])},null,2)])])]))}},be=Y(ce,[["__scopeId","data-v-1a57acff"]]),me={class:"peerSettingContainer w-100 h-100 position-absolute top-0 start-0 overflow-y-scroll",ref:"editConfigurationContainer"},fe={class:"d-flex h-100 w-100"},pe={class:"modal-dialog-centered dashboardModal w-100 h-100 overflow-x-scroll flex-column gap-3 mx-3"},ve={class:"my-5 d-flex gap-3 flex-column position-relative"},ge={class:"title"},ke={class:"d-flex mb-3"},xe={class:"mb-0"},ye={class:"position-relative d-flex flex-column gap-3"},_e={class:"text-center title",key:"spinner"},he={class:"card my-0 rounded-3",key:"noBackups"},Ce={class:"card-body text-center text-muted"},$e={__name:"configurationBackupRestore",emits:["close","refreshPeersList"],setup(m,{emit:_}){const d=R(),i=v([]),l=v(!0),g=_;V(()=>{k()});const k=()=>{l.value=!0,$("/api/getWireguardConfigurationBackup",{configurationName:d.params.id},o=>{i.value=o.data,l.value=!1})},f=()=>{$("/api/createWireguardConfigurationBackup",{configurationName:d.params.id},o=>{i.value=o.data,l.value=!1})};return(o,t)=>(r(),c("div",me,[e("div",fe,[e("div",pe,[e("div",ve,[e("div",ge,[e("div",ke,[e("h4",xe,[a(n,{t:"Backup & Restore"})]),e("button",{type:"button",class:"btn-close ms-auto",onClick:t[0]||(t[0]=p=>o.$emit("close"))})]),e("button",{onClick:t[1]||(t[1]=p=>f()),class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-3 w-100"},[t[4]||(t[4]=e("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),a(n,{t:"Create Backup"})])]),e("div",ye,[a(j,{name:"list1"},{default:C(()=>[l.value&&i.value.length===0?(r(),c("div",_e,t[5]||(t[5]=[e("div",{class:"spinner-border"},null,-1)]))):!l.value&&i.value.length===0?(r(),c("div",he,[e("div",Ce,[t[6]||(t[6]=e("i",{class:"bi bi-x-circle-fill me-2"},null,-1)),a(n,{t:"No backup yet, click the button above to create backup."})])])):y("",!0),(r(!0),c(W,null,z(i.value,p=>(r(),H(be,{onRefresh:t[2]||(t[2]=h=>k()),onRefreshPeersList:t[3]||(t[3]=h=>g("refreshPeersList")),b:p,key:p.filename},null,8,["b"]))),128))]),_:1})])])])])],512))}},De=Y($e,[["__scopeId","data-v-1f718118"]]);export{De as default};
